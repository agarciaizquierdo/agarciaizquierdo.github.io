---
layout: post
title: PROBLEMAS REPLICACION DIRECTORIO ACTIVO
date: 2011-04-08 19:42
author: agarciaizquierdo
comments: true
categories: [DIRECTORIO ACTIVO, Sin categoría, SYSVOL, WINDOWS 2003, WINDOWS 2008]
---
Buenas hoy voy a a hablaros de un procedimiento poco habitual, pero que en muchas ocasiones nos puede salvar la vida. En algunos entornos nos podemos encontrar con un dominio y DCs muy deteriorados y nos encontremos con problemas de que los DCs no replican, que algunos DCs no tengan compartida la carpeta SYSVOL...En estos casos podemos usar varios comando muy interesantes para saber si nuestros DCs se están comunicando bien o no.<br /><ul><li><span class="Apple-style-span" style="line-height:13px;"><span style="border-width:0;font-style:inherit;margin:0;outline-width:0;padding:0;"><span class="Apple-style-span" style="font-family:inherit;">repadmin /replsummary: </span></span></span>el cual nos puede dar informacion sobre la comunicación entre los DCs</li><li>netdom query fsmo: ejecutando este comando desde cualquier DC del dominio nos puede dar información sobre en que DCs se encuentra cada rol, en ocasiones si algún DC tiene problemas de comunicación puede no devolver ningún dato y dar problemas de que no encuentra ningún dominio</li><li>net share: con este comando podemos confirmar si se esta compartiendo el directorio "SYSVOL"</li></ul><div>Bueno si tras estas pruebas seguimos sin dar con una solución, podemos realizar un procedimiento un tanto critico, pero que nos puede salvar la vida. Repito que es un procedimiento delicado y no se debe de usar a la ligera.</div><div><ul><li>Abrimos un cmd en el servidor que tiene los roles o en mejor estado se encuntra</li><li>Paramos el servicio ntfrs con "net stop ntfrs"</li><li>En el registro del sistema vamos a la ruta "<span class="Apple-style-span" style="font-family:inherit;">HKLM\SYSTEM\CURRENT CONTROL SET\SERVICES\NTFRS\PARAMETERS\BACKUP &amp; RESTORE\PROCESS AT STARTUP</span><span class="Apple-style-span" style="font-family:inherit;">" y a la clave "BURFLAG" de pone el valor "D4"</span></li><li>En los demas servidores paramos el servicio ntfrs y nos vamos a la misma ruta del registro pero ponemos el valor "D2"</li><li>Arrancamos el servicio en todos los servidores con el comando "net start ntfrs"</li></ul><div>Y si todo ha ido bien todos nuestros DCs deberían comenzar a replicarse.</div></div><div>Como información adicional os pongo unos articulos de la KB de Micrososft con información muy interesante.<span class="Apple-style-span" style="font-size:small;"><i><span lang="EN-US" style="color:black;">    </span></i></span><span class="Apple-style-span" style="font-size:small;"><i><span lang="EN-US" style="color:black;font-size:12pt;font-weight:normal;"><span style="font-size:small;"></span></span></i></span><br /><ul><li><span class="Apple-style-span" style="font-size:small;"><i><span lang="EN-US" style="color:black;font-size:12pt;font-weight:normal;"><span style="font-size:small;"><a href="http://support.microsoft.com/kb/290762">KB 290762</a></span></span></i></span></li><li><span class="Apple-style-span" style="font-size:small;"><i><span lang="EN-US" style="color:black;font-size:12pt;font-weight:normal;"><span style="font-size:small;"><a href="http://support.microsoft.com/kb/2218556">KB 2218556</a> </span></span></i></span></li><li><span class="Apple-style-span" style="font-size:small;"><i><span lang="EN-US" style="color:black;font-size:12pt;font-weight:normal;"><span style="font-size:small;"><a href="http://support.microsoft.com/kb/315457">KB 315457</a></span></span></i></span></li></ul><span class="Apple-style-span" style="font-size:small;"><i><span lang="EN-US" style="color:black;font-size:12pt;font-weight:normal;"><span style="font-size:small;"> </span></span></i></span></div><div><span class="Apple-style-span" style="font-size:small;"><i><span lang="EN-US" style="color:black;font-size:12pt;font-weight:normal;"><span style="font-size:small;"></span></span></i></span></div><div><span class="Apple-style-span" style="font-size:small;"><i><span lang="EN-US" style="color:black;font-size:12pt;font-weight:normal;"><span style="font-size:small;"></span></span></i></span></div><div><span class="Apple-style-span" style="font-size:small;"><i><span lang="EN-US" style="color:black;font-size:12pt;font-weight:normal;"><span style="font-size:small;"></span></span></i></span></div><div><span class="Apple-style-span" style="font-size:small;"><i><span lang="EN-US" style="color:black;font-size:12pt;font-weight:normal;"><span style="font-size:small;"><br /></span></span></i></span><br /><h1 class="title" style="box-sizing:border-box;margin:0 0 10px;"><span class="Apple-style-span"><div style="font-weight:normal;margin:0;"><div style="font-size:medium;font-style:italic;"><span class="Apple-style-span" style="font-style:normal;">Un saludo</span></div></div></span></h1></div>
